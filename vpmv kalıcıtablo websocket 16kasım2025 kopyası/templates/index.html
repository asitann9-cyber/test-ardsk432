<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ¯ Supertrend + C-Signal + VPMV Analiz Sistemi</title>
  
  <!-- External Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/locale/tr.min.js"></script>
  
  <!-- Styles -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
  <div class="container">
    <!-- Main Header -->
    <div class="main-header">
      <h1 class="main-title">
        <span>ğŸ¯</span>
        Supertrend + C-Signal + VPMV Analiz Sistemi
      </h1>
      <p class="main-subtitle">
        Binance Vadeli Ä°ÅŸlemler - Supertrend Ratio % + Z-Score + VPMV NET POWER + DÄ°NAMÄ°K C-Signal Â±X L/S
      </p>
    </div>

    <!-- Symbol Management Panel -->
    <div class="panel">
      <div class="panel-header">
        <div class="panel-title">
          <span>ğŸ’°</span>
          Emtia YÃ¶netimi
        </div>
      </div>
      
      <div class="controls-grid">
        <div class="form-group">
          <label class="form-label">ğŸ” Mevcut Emtialar</label>
          <select id="available-symbols" multiple size="6" style="height: 150px;">
            <option disabled>YÃ¼kleniyor...</option>
          </select>
        </div>
        
        <div class="form-group">
          <label class="form-label">âœ… SeÃ§ili EmtialarÄ±m</label>
          <div id="selected-symbols-list" style="height: 150px; overflow-y: auto; background: var(--darker-bg); border: 2px solid var(--border-color); border-radius: 8px; padding: 10px;">
            <div style="color: var(--text-muted); font-style: italic;">HenÃ¼z emtia seÃ§ilmedi</div>
          </div>
        </div>
      </div>
      
      <div class="btn-group">
        <button id="add-symbols" class="btn btn-success">
          <span>â•</span>
          SeÃ§ili EmtialarÄ± Ekle
        </button>
        <button id="select-all" class="btn btn-warning">
          <span>ğŸ“Š</span>
          TÃ¼mÃ¼nÃ¼ SeÃ§
        </button>
        <button id="refresh-symbols" class="btn btn-info">
          <span>ğŸ”„</span>
          Listeyi Yenile
        </button>
        <button id="clear-symbols" class="btn btn-danger">
          <span>ğŸ—‘ï¸</span>
          TÃ¼mÃ¼nÃ¼ Temizle
        </button>
      </div>
      
      <div class="status-message status-info" id="symbol-status">
        ğŸ“Š Emtia listesi yÃ¼kleniyor...
      </div>
    </div>

    <!-- System Settings Panel -->
    <div class="panel">
      <div class="panel-header">
        <div class="panel-title">
          <span>âš™ï¸</span>
          Sistem AyarlarÄ±
        </div>
      </div>
      
      <div class="controls-grid">
        <!-- RATIO THRESHOLD -->
        <div class="form-group">
          <label class="form-label">ğŸ¯ KalÄ±cÄ± Liste Kriteri - Minimum Ratio %</label>
          <input type="number" 
                 id="min-ratio-threshold" 
                 min="0" 
                 max="500" 
                 step="10" 
                 value="100"
                 style="font-weight: bold; font-size: 16px;">
          <small style="color: var(--text-muted); font-size: 11px; margin-top: 4px; display: block;">
            Bu deÄŸerin Ã¼zerindeki ratio'ya sahip emtialar otomatik olarak kalÄ±cÄ± listeye eklenir
          </small>
        </div>
        
        <!-- C-SIGNAL THRESHOLD -->
        <div class="form-group">
          <label class="form-label">ğŸ”” C-Signal Alert Threshold Â±X</label>
          <input type="number" 
                 id="c-signal-threshold" 
                 min="0" 
                 max="100" 
                 step="1" 
                 value="20"
                 style="font-weight: bold; font-size: 16px; color: var(--warning-color);">
          <small style="color: var(--text-muted); font-size: 11px; margin-top: 4px; display: block;">
            C-Signal >= +X = LONG (L) | C-Signal <= -X = SHORT (S) sinyali
          </small>
        </div>
        
        <div class="form-group">
          <label class="form-label">ğŸ’¾ AyarlarÄ± Kaydet</label>
          <button id="save-settings" class="btn btn-success">
            <span>ğŸ’¾</span>
            AyarlarÄ± Kaydet
          </button>
        </div>
      </div>
      
      <!-- MEVCUT AYARLAR GÃ–STERGE PANELÄ° -->
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
        <div style="padding: 12px; background: var(--darker-bg); border: 2px solid var(--success-color); border-radius: 8px;">
          <div style="font-size: 11px; color: var(--text-muted); margin-bottom: 4px;">ğŸ“Š Ratio Threshold</div>
          <div style="font-weight: bold; color: var(--success-color); font-size: 18px;">
            â‰¥ <span id="current-threshold-display">100</span>%
          </div>
        </div>
        
        <div style="padding: 12px; background: var(--darker-bg); border: 2px solid var(--warning-color); border-radius: 8px;">
          <div style="font-size: 11px; color: var(--text-muted); margin-bottom: 4px;">ğŸ”” C-Signal Threshold</div>
          <div style="font-weight: bold; color: var(--warning-color); font-size: 18px;">
            Â± <span id="current-c-signal-display">20</span>
          </div>
        </div>
      </div>
      
      <div class="status-message status-info" id="settings-status">
        âš™ï¸ Mevcut ayarlar: <strong>Ratio â‰¥ 100%</strong> | <strong>C-Signal Â±20</strong>
      </div>
    </div>

    <!-- Analysis Panel -->
    <div class="panel">
      <div class="panel-header">
        <div class="panel-title">
          <span>ğŸ¯</span>
          Supertrend + VPMV Analizi
        </div>
      </div>
      
      <div class="controls-grid">
        <div class="form-group">
          <label class="form-label">â° Timeframe</label>
          <select id="timeframe">
            <option value="1m">1 Dakika</option>
            <option value="5m">5 Dakika</option>
            <option value="15m">15 Dakika</option>
            <option value="30m">30 Dakika</option>
            <option value="1h">1 Saat</option>
            <option value="2h">2 Saat</option>
            <option value="4h" selected>4 Saat</option>
            <option value="1d">1 GÃ¼n</option>
          </select>
        </div>
        
        <div class="form-group">
          <label class="form-label">ğŸ¯ Ä°ÅŸlem</label>
          <button id="start-analysis" class="btn btn-primary">
            <span>ğŸš€</span>
            Analiz BaÅŸlat
          </button>
        </div>
        
        <div class="form-group">
          <label class="form-label">â¹ï¸ Durdur</label>
          <button id="stop-auto-update" class="btn btn-danger" disabled>
            <span>â¹ï¸</span>
            Durdur
          </button>
        </div>
      </div>
      
      <div class="status-message status-info" id="analysis-status">
        ğŸ“Š Analiz iÃ§in butona tÄ±klayÄ±n
      </div>
    </div>

    <!-- Results Section - Supertrend Analizi -->
    <div class="panel">
      <div class="panel-header">
        <div class="panel-title">
          <span>ğŸ“ˆ</span>
          Analiz SonuÃ§larÄ± - Supertrend Ratio % + Z-Score + VPMV
        </div>
      </div>
      
      <!-- Filter Buttons -->
      <div class="filter-buttons" style="margin-bottom: 15px; display: flex; gap: 5px; flex-wrap: wrap; align-items: center;">
        
        <!-- ARAMA KUTUSU - OTOMATIK TAMAMLAMA -->
        <div class="search-container" style="margin-right: 15px; position: relative;">
          <input type="text" 
                 id="symbol-search" 
                 placeholder="ğŸ” Sembol ara (Ã¶r: BTC, ETH, M)"
                 style="padding: 8px 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--darker-bg); color: var(--text-primary); font-size: 13px; width: 220px; font-weight: 500;"
                 autocomplete="off">
          <div id="search-dropdown" class="search-dropdown" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: var(--card-bg); border: 2px solid var(--border-color); border-top: none; border-radius: 0 0 8px 8px; max-height: 200px; overflow-y: auto; z-index: 1000; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
            <!-- Ã–neri listesi buraya gelecek -->
          </div>
        </div>
        
        <button id="filter-all" class="btn-filter active">
          ğŸ“Š HEPSÄ°
        </button>
        <button id="filter-bullish" class="btn-filter">
          ğŸŸ¢ BULLISH
        </button>
        <button id="filter-bearish" class="btn-filter">
          ğŸ”´ BEARISH
        </button>
        <button id="filter-high-ratio" class="btn-filter">
          ğŸ”¥ %100+ RATÄ°O
        </button>
        <div style="margin-left: auto; font-size: 12px; color: var(--text-muted); display: flex; align-items: center;">
          <span id="filter-count">0 sonuÃ§</span>
        </div>
      </div>
      
      <div style="max-height: 600px; overflow-y: auto; background: var(--darker-bg); border-radius: 8px; border: 2px solid var(--border-color);">
        <table id="consecutive-results-table">
          <thead>
            <tr>
              <th>SÄ±ra</th>
              <th>Sembol</th>
              <th>Fiyat</th>
              <th>Ratio %</th>
              <th>Z-Score</th>
              <th>ğŸ† Manuel Ekle</th>
            </tr>
          </thead>
          <tbody id="consecutive-results-tbody">
            <tr>
              <td colspan="6" style="padding: 20px; text-align: center; color: var(--text-muted);">
                ğŸ“Š Analiz sonuÃ§larÄ± burada gÃ¶rÃ¼necek
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ğŸ†• Permanent High Ratio Section - VPMV SÃœTUNLARI EKLENDÄ° -->
    <div class="panel">
      <div class="panel-header">
        <div class="panel-title">
          <span>ğŸ†</span>
          KalÄ±cÄ± %100+ Ratio Emtialar - VPMV NET POWER + C-SIGNAL Â±X
        </div>
        <div class="btn-group">
          <button id="refresh-permanent" class="btn btn-info">
            <span>ğŸ”„</span>
            Yenile
          </button>
          <button id="clear-permanent" class="btn btn-danger">
            <span>ğŸ—‘ï¸</span>
            Temizle
          </button>
        </div>
      </div>
      
      <!-- C-SIGNAL ALERT SAYISI + THRESHOLD GÃ–STERGE -->
      <div class="status-message status-info" id="permanent-status">
        ğŸ† %100+ ratio olan emtialar + <span id="c-signal-count" style="font-weight: bold; color: var(--warning-color);">0 aktif C-Signal (Â±<span id="c-signal-threshold-display">20</span>)</span>
      </div>
      
      <div style="max-height: 500px; overflow-y: auto; background: var(--darker-bg); border-radius: 8px; border: 2px solid var(--border-color);">
        <table id="permanent-results-table">
          <thead>
            <tr>
              <th>SÄ±ra</th>
              <th>Sembol</th>
              <th>Ä°lk KayÄ±t</th>
              <th>Ratio %</th>
              <th>ğŸ“ Trend TÃ¼rÃ¼</th>
              <th>C-Signal</th>
              <th>ğŸ”” CÂ±X Sinyal</th>
              <!-- ğŸ†• VPMV SÃœTUNLARI -->
              <th>ğŸ¯ VPMV NET</th>
              <th>ğŸ“Š VPMV Signal</th>
              <th>ğŸ—‘ï¸ Ä°ÅŸlem</th>
            </tr>
          </thead>
          <tbody id="permanent-results-tbody">
            <tr>
              <td colspan="10" style="padding: 20px; text-align: center; color: var(--text-muted);">
                ğŸ† HenÃ¼z %100+ ratio olan emtia yok
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <!-- ğŸ†• SÄ°STEM AÃ‡IKLAMASI - VPMV EKLENDÄ° -->
      <div style="margin-top: 15px; padding: 12px; background: linear-gradient(135deg, rgba(41, 98, 255, 0.1), rgba(52, 152, 219, 0.1)); border: 1px solid var(--primary-color); border-radius: 8px; font-size: 12px; color: var(--text-secondary);">
        <strong>ğŸ¯ Supertrend + VPMV Analiz Sistemi:</strong><br>
        ğŸ“Š <strong>Supertrend Ratio</strong>: Pullback seviyesinden mevcut fiyatÄ±n uzaklÄ±ÄŸÄ± (%)<br>
        ğŸ“ˆ <strong>Z-Score</strong>: Ä°statistiksel aÅŸÄ±rÄ±lÄ±k Ã¶lÃ§Ã¼mÃ¼ (Â±2 Ã¼zeri yÃ¼ksek)<br>
        ğŸ’¡ <strong>C-Signal</strong>: RSI momentum deÄŸiÅŸimi (trend gÃ¼cÃ¼ gÃ¶stergesi)<br>
        ğŸ”” <strong>DÄ°NAMÄ°K CÂ±X Sinyal</strong>: Panel'den ayarlanabilir! C >= +X = ğŸŸ¢ LONG (L) | C <= -X = ğŸ”´ SHORT (S)<br>
        ğŸ¯ <strong>VPMV NET POWER</strong>: Volume-Price-Momentum-Volatility unified deÄŸeri (-100 ile +100 arasÄ±)<br>
        ğŸ“Š <strong>VPMV Signal</strong>: STRONG LONG (>10) | LONG (>0) | SHORT (<0) | STRONG SHORT (<-10) | NEUTRAL (0)<br>
        ğŸ“ <strong>Manuel TÃ¼r DeÄŸiÅŸtirme</strong>: Dropdown'dan Bullish/Bearish deÄŸiÅŸtirme = TÃ¼r kilitlenir<br>
        ğŸ¯ <strong>KalÄ±cÄ± Kriter</strong>: Supertrend Ratio >= %100 (panel'den ayarlanabilir)<br>
        ğŸ”’ <strong>Manuel Kilitleme</strong>: DeÄŸiÅŸtirilen tÃ¼r otomatik gÃ¼ncellemelerde korunur<br>
        âš™ï¸ <strong>Ayarlanabilir Threshold'lar</strong>: Hem Ratio hem C-Signal threshold'larÄ±nÄ± panel'den deÄŸiÅŸtirebilirsiniz<br>
        ğŸ”„ <strong>SuperTrend Reset</strong>: VPMV hesaplamalarÄ± SuperTrend yÃ¶n deÄŸiÅŸiminde sÄ±fÄ±rlanÄ±r
      </div>
    </div>
  </div>

  <!-- JavaScript dosyasÄ± -->
  <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>